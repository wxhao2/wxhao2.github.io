<!DOCTYPE html>
<html>
  <!-- Html Head Tag-->
  <head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="wxhao">
  <!-- Open Graph Data -->
  <meta property="og:title" content="网络编程"/>
  <meta property="og:description" content="站点描述" />
  <meta property="og:site_name" content="标题"/>
  <meta property="og:type" content="article" />
  <meta property="og:image" content="http://blog.wxhaoo.comundefined"/>
  
    <link rel="alternate" href="/atom.xml" title="标题" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  

  <!-- Site Title -->
  <title>标题</title>

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <!-- Custom CSS -->
  
  <link rel="stylesheet" href="/css/style.light.css">

  <!-- Google Analytics -->
  

</head>

  <body>
    <!-- Page Header -->


<header class="site-header header-background" style="background-image: url(/img/default-banner-dark.jpg)">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="page-title with-background-image">
          <p class="title">网络编程</p>
          <p class="subtitle"></p>
        </div>
        <div class="site-menu with-background-image">
          <ul>
            
              <li>
                <a href="/">
                  
                  Home
                  
                </a>
              </li>
            
              <li>
                <a href="/archives">
                  
                  Archives
                  
                </a>
              </li>
            
              <li>
                <a href="https://github.com/levblanc">
                  
                  Github
                  
                </a>
              </li>
            
              <li>
                <a href="mailto:levblanc@163.com">
                  
                  Email
                  
                </a>
              </li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>
</header>


<article>
  <div class="container typo">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="post-info text-muted">
          
            <!-- Author -->
            <span class="author info">By wxhao</span>
          
          <!-- Date -->
          <span class="date-time info">On
            <span class="date">2013-10-25</span>
            <span class="time">17:38:06</span>
          </span>
          
        </div>
        <!-- Tags -->
        
          <div class="post-tags text-muted">
            Tags: 

<a class="tag" href="/tags/基础知识/">#基础知识</a> <a class="tag" href="/tags/java/">#java</a> <a class="tag" href="/tags/JAVASE/">#JAVASE</a>


          </div>
        
        <!-- Post Main Content -->
        <div class="post-content">
          <p>###网络编程概述</p>
<ul>
<li>A:计算机网络<ul>
<li>是指将地理位置不同的具有独立功能的多台计算机及其外部设备，通过通信线路连接起来，在网络操作系统，网络管理软件及网络通信协议的管理和协调下，实现资源共享和信息传递的计算机系统。</li>
</ul>
</li>
<li>B:网络编程<ul>
<li>就是用来实现网络互连的不同计算机上运行的程序间可以进行数据交换。</li>
</ul>
</li>
</ul>
<h3 id="网络编程三要素之IP概述"><a href="#网络编程三要素之IP概述" class="headerlink" title="网络编程三要素之IP概述"></a>网络编程三要素之IP概述</h3><ul>
<li>每个设备在网络中的唯一标识</li>
<li>每台网络终端在网络中都有一个独立的地址，我们在网络中传输数据就是使用这个地址。 </li>
<li>ipconfig：查看本机IP192.168.12.42</li>
<li>ping：测试连接192.168.40.62</li>
<li>本地回路地址：127.0.0.1 255.255.255.255是广播地址</li>
<li>IPv4：4个字节组成，4个0-255。大概42亿，30亿都在北美，亚洲4亿。2011年初已经用尽。 </li>
<li>IPv6：8组，每组4个16进制数。</li>
<li>中间的有4个0就可以省略,但是同一个IPV6地址只能省略一处</li>
<li>1a2b:0000:aaaa:0000:0000:0000:aabb:1f2f</li>
<li>1a2b::aaaa:0000:0000:0000:aabb:1f2f</li>
<li>1a2b:0000:aaaa::aabb:1f2f</li>
<li>1a2b:0000:aaaa::0000:aabb:1f2f</li>
<li>1a2b:0000:aaaa:0000::aabb:1f2f</li>
</ul>
<h3 id="网络编程三要素之端口号概述"><a href="#网络编程三要素之端口号概述" class="headerlink" title="网络编程三要素之端口号概述"></a>网络编程三要素之端口号概述</h3><ul>
<li>每个程序在设备上的唯一标识</li>
<li>每个网络程序都需要绑定一个端口号，传输数据的时候除了确定发到哪台机器上，还要明确发到哪个程序。</li>
<li>端口号范围从0-65535</li>
<li>编写网络应用就需要绑定一个端口号，尽量使用1024以上的，1024以下的基本上都被系统程序占用了。</li>
<li>常用端口<ul>
<li>mysql: 3306</li>
<li>oracle: 1521</li>
<li>web: 80</li>
<li>tomcat: 8080</li>
<li>QQ: 4000</li>
<li>feiQ: 2425</li>
</ul>
</li>
</ul>
<h3 id="网络编程三要素协议"><a href="#网络编程三要素协议" class="headerlink" title="网络编程三要素协议"></a>网络编程三要素协议</h3><ul>
<li>为计算机网络中进行数据交换而建立的规则、标准或约定的集合。</li>
<li>UDP(类似发短息,不管你开不开机都可以给你发)<ul>
<li>面向无连接，数据不安全，速度快。不区分客户端与服务端。</li>
</ul>
</li>
<li>TCP(类似打电话,你必须要接听,才能打)<br>　　* 面向连接（三次握手），数据安全，速度略低。分为客户端和服务端。<ul>
<li>三次握手: 客户端先向服务端发起请求, 服务端响应请求, 传输数据</li>
</ul>
</li>
</ul>
<h3 id="Socket通信原理图解"><a href="#Socket通信原理图解" class="headerlink" title="Socket通信原理图解"></a>Socket通信原理图解</h3><ul>
<li>A:Socket套接字概述：<ul>
<li>网络上具有唯一标识的IP地址和端口号组合在一起才能构成唯一能识别的标识符套接字。</li>
<li>通信的两端都有Socket。</li>
<li>网络通信其实就是Socket间的通信。</li>
<li>数据在两个Socket间通过IO流传输。</li>
<li>Socket在应用程序中创建，通过一种绑定机制与驱动程序建立关系，告诉自己所对应的IP和port。</li>
</ul>
</li>
</ul>
<p><img src="/socket.png" alt="socket"></p>
<h3 id="UDP传输"><a href="#UDP传输" class="headerlink" title="UDP传输"></a>UDP传输</h3><ul>
<li>1.发送Send<ul>
<li>创建DatagramSocket, 随机端口号</li>
<li>创建DatagramPacket, 指定数据, 长度, 地址, 端口</li>
<li>使用DatagramSocket发送DatagramPacket</li>
<li>关闭DatagramSocket</li>
</ul>
</li>
<li>2.接收Receive<ul>
<li>创建DatagramSocket, 指定端口号</li>
<li>创建DatagramPacket, 指定数组, 长度</li>
<li>使用DatagramSocket接收DatagramPacket</li>
<li>关闭DatagramSocket</li>
<li>从DatagramPacket中获取数据</li>
</ul>
</li>
<li>3.接收方获取ip和端口号<ul>
<li>String ip = packet.getAddress().getHostAddress();</li>
<li>int port = packet.getPort();</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">package com.wxhao.socket;</div><div class="line"></div><div class="line">import java.net.DatagramPacket;</div><div class="line">import java.net.DatagramSocket;</div><div class="line">import java.net.InetAddress;</div><div class="line">import java.net.SocketException;</div><div class="line">import java.net.UnknownHostException;</div><div class="line"></div><div class="line">public class Demo1_Send &#123;</div><div class="line"></div><div class="line">	/**</div><div class="line">	 * * 1.发送Send</div><div class="line">	 * 创建DatagramSocket, 随机端口号</div><div class="line">	 * 创建DatagramPacket, 指定数据, 长度, 地址, 端口</div><div class="line">	 * 使用DatagramSocket发送DatagramPacket</div><div class="line">	 * 关闭DatagramSocket</div><div class="line">	 * @throws SocketException </div><div class="line">	 * @throws UnknownHostException </div><div class="line">	 */</div><div class="line">	public static void main(String[] args) throws Exception &#123;</div><div class="line">		String str = &quot;what are you 弄啥呢?&quot;;</div><div class="line">		DatagramSocket socket = new DatagramSocket();	//创建Socket相当于创建码头</div><div class="line">		DatagramPacket packet = 						//创建Packet相当于集装箱</div><div class="line">				new DatagramPacket(str.getBytes(), str.getBytes().length, InetAddress.getByName(&quot;127.0.0.1&quot;), 6666);</div><div class="line">		socket.send(packet);							//发货,将数据发出去</div><div class="line">		socket.close();									//关闭码头</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">package com.wxhao.socket;</div><div class="line"></div><div class="line">import java.net.DatagramPacket;</div><div class="line">import java.net.DatagramSocket;</div><div class="line">import java.net.SocketException;</div><div class="line"></div><div class="line">public class Demo1_Receive &#123;</div><div class="line"></div><div class="line">	/**</div><div class="line">	 ** 2.接收Receive</div><div class="line">	 * 创建DatagramSocket, 指定端口号</div><div class="line">	 * 创建DatagramPacket, 指定数组, 长度</div><div class="line">	 * 使用DatagramSocket接收DatagramPacket</div><div class="line">	 * 关闭DatagramSocket</div><div class="line">	 * 从DatagramPacket中获取数据</div><div class="line">	 * @throws Exception </div><div class="line">	 */</div><div class="line">	public static void main(String[] args) throws Exception &#123;</div><div class="line">		DatagramSocket socket = new DatagramSocket(6666);//创建Socket相当于创建码头</div><div class="line">		DatagramPacket packet = new DatagramPacket(new byte[1024], 1024);//创建Packet相当于创建集装箱</div><div class="line">		socket.receive(packet);							//接货,接收数据</div><div class="line">		byte[] arr = packet.getData();					//获取数据</div><div class="line">		int len = packet.getLength();					//获取有效的字节个数</div><div class="line">		System.out.println(new String(arr,0,len));</div><div class="line">		socket.close();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="UDP传输优化"><a href="#UDP传输优化" class="headerlink" title="UDP传输优化"></a>UDP传输优化</h3><ul>
<li>接收端Receive</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">DatagramSocket socket = new DatagramSocket(6666);//创建Socket相当于创建码头</div><div class="line">DatagramPacket packet = new DatagramPacket(new byte[1024], 1024);//创建Packet相当于创建集装箱</div><div class="line"></div><div class="line">while(true) &#123;</div><div class="line">	socket.receive(packet);						//接货,接收数据</div><div class="line">	byte[] arr = packet.getData();				//获取数据</div><div class="line">	int len = packet.getLength();				//获取有效的字节个数</div><div class="line">	String ip = packet.getAddress().getHostAddress();//获取ip地址</div><div class="line">	int port = packet.getPort();				//获取端口号</div><div class="line">	System.out.println(ip + &quot;:&quot; + port + &quot;:&quot; + new String(arr,0,len));</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>发送端Send</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">Scanner sc = new Scanner(System.in);		//创建键盘录入对象</div><div class="line">DatagramSocket socket = new DatagramSocket();//创建Socket相当于创建码头</div><div class="line">while(true) &#123;</div><div class="line">	String line = sc.nextLine();			//获取键盘录入的字符串</div><div class="line">	if(&quot;quit&quot;.equals(line)) &#123;</div><div class="line">		break;</div><div class="line">	&#125;</div><div class="line">	DatagramPacket packet = 			//创建Packet相当于集装箱</div><div class="line">			new DatagramPacket(line.getBytes(), line.getBytes().length, InetAddress.getByName(&quot;127.0.0.1&quot;), 6666);</div><div class="line">	socket.send(packet);				//发货,将数据发出去</div><div class="line">&#125;</div><div class="line">socket.close();							//关闭码头</div></pre></td></tr></table></figure>
<h3 id="UDP传输多线程"><a href="#UDP传输多线程" class="headerlink" title="UDP传输多线程"></a>UDP传输多线程</h3><ul>
<li>A发送和接收在一个窗口完成</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line">package com.wxhao.socket;</div><div class="line"></div><div class="line">import java.io.IOException;</div><div class="line">import java.net.DatagramPacket;</div><div class="line">import java.net.DatagramSocket;</div><div class="line">import java.net.InetAddress;</div><div class="line">import java.net.SocketException;</div><div class="line">import java.net.UnknownHostException;</div><div class="line">import java.util.Scanner;</div><div class="line"></div><div class="line">public class Demo3_MoreThread &#123;</div><div class="line"></div><div class="line">	public static void main(String[] args) &#123;</div><div class="line">		new Receive().start();</div><div class="line">		new Send().start();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">class Receive extends Thread &#123;</div><div class="line">	public void run() &#123;</div><div class="line">		try &#123;</div><div class="line">			DatagramSocket socket = new DatagramSocket(6666);//创建Socket相当于创建码头</div><div class="line">			DatagramPacket packet = new DatagramPacket(new byte[1024], 1024);//创建Packet相当于创建集装箱</div><div class="line">			while(true) &#123;</div><div class="line">				socket.receive(packet);						//接货,接收数据</div><div class="line">				byte[] arr = packet.getData();				//获取数据</div><div class="line">				int len = packet.getLength();				//获取有效的字节个数</div><div class="line">				String ip = packet.getAddress().getHostAddress();//获取ip地址</div><div class="line">				int port = packet.getPort();				//获取端口号</div><div class="line">				System.out.println(ip + &quot;:&quot; + port + &quot;:&quot; + new String(arr,0,len));</div><div class="line">			&#125;</div><div class="line">		&#125; catch (IOException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">class Send extends Thread &#123;</div><div class="line">	public void run() &#123;</div><div class="line">		try &#123;</div><div class="line">			Scanner sc = new Scanner(System.in);			//创建键盘录入对象</div><div class="line">			DatagramSocket socket = new DatagramSocket();	//创建Socket相当于创建码头</div><div class="line">			while(true) &#123;</div><div class="line">				String line = sc.nextLine();				//获取键盘录入的字符串</div><div class="line">				if(&quot;quit&quot;.equals(line)) &#123;</div><div class="line">					break;</div><div class="line">				&#125;</div><div class="line">				DatagramPacket packet = 					//创建Packet相当于集装箱</div><div class="line">						new DatagramPacket(line.getBytes(), line.getBytes().length, InetAddress.getByName(&quot;127.0.0.1&quot;), 6666);</div><div class="line">				socket.send(packet);						//发货,将数据发出去</div><div class="line">			&#125;</div><div class="line">			socket.close();</div><div class="line">		&#125;  catch (IOException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125;		</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="UDP聊天图形化界面"><a href="#UDP聊天图形化界面" class="headerlink" title="UDP聊天图形化界面"></a>UDP聊天图形化界面</h3><p><img src="!--￼15--&gt;/post-in/20131025/yxt.png" alt="原型图"></p>
<h3 id="UDP聊天发送功能"><a href="#UDP聊天发送功能" class="headerlink" title="UDP聊天发送功能"></a>UDP聊天发送功能</h3><h3 id="UDP聊天记录功能"><a href="#UDP聊天记录功能" class="headerlink" title="UDP聊天记录功能"></a>UDP聊天记录功能</h3><h3 id="UDP聊天清屏功能"><a href="#UDP聊天清屏功能" class="headerlink" title="UDP聊天清屏功能"></a>UDP聊天清屏功能</h3><h3 id="UDP聊天震动功能"><a href="#UDP聊天震动功能" class="headerlink" title="UDP聊天震动功能"></a>UDP聊天震动功能</h3><h3 id="UDP聊天快捷键和代码优化"><a href="#UDP聊天快捷键和代码优化" class="headerlink" title="UDP聊天快捷键和代码优化"></a>UDP聊天快捷键和代码优化</h3><h3 id="UDP聊天生成jar文件"><a href="#UDP聊天生成jar文件" class="headerlink" title="UDP聊天生成jar文件"></a>UDP聊天生成jar文件</h3><ul>
<li>可以用eclipse生成</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div></pre></td><td class="code"><pre><div class="line">package com.wxhao.socket;</div><div class="line"></div><div class="line">import java.awt.BorderLayout;</div><div class="line">import java.awt.Button;</div><div class="line">import java.awt.Color;</div><div class="line">import java.awt.Font;</div><div class="line">import java.awt.Frame;</div><div class="line">import java.awt.Panel;</div><div class="line">import java.awt.TextArea;</div><div class="line">import java.awt.TextField;</div><div class="line">import java.awt.event.ActionEvent;</div><div class="line">import java.awt.event.ActionListener;</div><div class="line">import java.awt.event.KeyAdapter;</div><div class="line">import java.awt.event.KeyEvent;</div><div class="line">import java.awt.event.WindowAdapter;</div><div class="line">import java.awt.event.WindowEvent;</div><div class="line">import java.io.BufferedWriter;</div><div class="line">import java.io.ByteArrayOutputStream;</div><div class="line">import java.io.FileInputStream;</div><div class="line">import java.io.FileWriter;</div><div class="line">import java.io.IOException;</div><div class="line">import java.net.DatagramPacket;</div><div class="line">import java.net.DatagramSocket;</div><div class="line">import java.net.InetAddress;</div><div class="line">import java.net.SocketException;</div><div class="line">import java.net.UnknownHostException;</div><div class="line">import java.text.SimpleDateFormat;</div><div class="line">import java.util.Date;</div><div class="line"></div><div class="line">public class Demo4_GUIChat extends Frame &#123;</div><div class="line"></div><div class="line">	private TextField tf;</div><div class="line">	private Button send;</div><div class="line">	private Button log;</div><div class="line">	private Button clear;</div><div class="line">	private Button shake;</div><div class="line">	private TextArea viewText;</div><div class="line">	private TextArea sendText;</div><div class="line">	private DatagramSocket socket;</div><div class="line">	private BufferedWriter bw;</div><div class="line">	/**</div><div class="line">	 * GUI聊天</div><div class="line">	 */</div><div class="line">	public Demo4_GUIChat() &#123;</div><div class="line">		init();</div><div class="line">		southPanel();</div><div class="line">		centerPanel();</div><div class="line">		event();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	public void event() &#123;</div><div class="line">		this.addWindowListener(new WindowAdapter() &#123;</div><div class="line">			@Override</div><div class="line">			public void windowClosing(WindowEvent e) &#123;</div><div class="line">				try &#123;</div><div class="line">					socket.close();</div><div class="line">					bw.close();</div><div class="line">				&#125; catch (IOException e1) &#123;</div><div class="line">					</div><div class="line">					e1.printStackTrace();</div><div class="line">				&#125;</div><div class="line">				System.exit(0);</div><div class="line">			&#125;</div><div class="line">		&#125;);</div><div class="line">		</div><div class="line">		send.addActionListener(new ActionListener() &#123;</div><div class="line">			</div><div class="line">			@Override</div><div class="line">			public void actionPerformed(ActionEvent e) &#123;</div><div class="line">				try &#123;</div><div class="line">					send();</div><div class="line">				&#125; catch (IOException e1) &#123;</div><div class="line">					</div><div class="line">					e1.printStackTrace();</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line"></div><div class="line">		&#125;);</div><div class="line">		</div><div class="line">		log.addActionListener(new ActionListener() &#123;</div><div class="line">			</div><div class="line">			@Override</div><div class="line">			public void actionPerformed(ActionEvent e) &#123;</div><div class="line">				try &#123;</div><div class="line">					logFile();</div><div class="line">				&#125; catch (IOException e1) &#123;</div><div class="line">					</div><div class="line">					e1.printStackTrace();</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line"></div><div class="line">		&#125;);</div><div class="line">		</div><div class="line">		clear.addActionListener(new ActionListener() &#123;</div><div class="line">			</div><div class="line">			@Override</div><div class="line">			public void actionPerformed(ActionEvent e) &#123;</div><div class="line">				viewText.setText(&quot;&quot;);</div><div class="line">			&#125;</div><div class="line">		&#125;);</div><div class="line">		</div><div class="line">		shake.addActionListener(new ActionListener() &#123;</div><div class="line">			</div><div class="line">			@Override</div><div class="line">			public void actionPerformed(ActionEvent e) &#123;</div><div class="line">				try &#123;</div><div class="line">					send(new byte[]&#123;-1&#125;,tf.getText());</div><div class="line">				&#125; catch (IOException e1) &#123;</div><div class="line">					</div><div class="line">					e1.printStackTrace();</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line"></div><div class="line">		&#125;);</div><div class="line">		</div><div class="line">		sendText.addKeyListener(new KeyAdapter() &#123;</div><div class="line">			@Override</div><div class="line">			public void keyReleased(KeyEvent e) &#123;</div><div class="line">				//if(e.getKeyCode() == KeyEvent.VK_ENTER &amp;&amp; e.isControlDown()) &#123;	//isControlDown ctrl是否被按下</div><div class="line">				if(e.getKeyCode() == KeyEvent.VK_ENTER) &#123;</div><div class="line">					try &#123;</div><div class="line">						send();</div><div class="line">					&#125; catch (IOException e1) &#123;</div><div class="line">						</div><div class="line">						e1.printStackTrace();</div><div class="line">					&#125;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line"></div><div class="line">	private void shake() &#123;</div><div class="line">		int x = this.getLocation().x;							//获取横坐标位置</div><div class="line">		int y = this.getLocation().y;							//获取纵坐标位置</div><div class="line">		</div><div class="line">		for(int i = 0; i &lt; 20; i++) &#123;</div><div class="line">			try &#123;</div><div class="line">				this.setLocation(x + 20, y + 20);</div><div class="line">				Thread.sleep(20);</div><div class="line">				this.setLocation(x + 20, y - 20);</div><div class="line">				Thread.sleep(20);</div><div class="line">				this.setLocation(x - 20, y + 20);</div><div class="line">				Thread.sleep(20);</div><div class="line">				this.setLocation(x - 20, y - 20);</div><div class="line">				Thread.sleep(20);</div><div class="line">				this.setLocation(x, y);</div><div class="line">			&#125; catch (InterruptedException e) &#123;</div><div class="line">				</div><div class="line">				e.printStackTrace();</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	private void logFile() throws IOException &#123;</div><div class="line">		bw.flush();									//刷新缓冲区</div><div class="line">		FileInputStream fis = new FileInputStream(&quot;config.txt&quot;);</div><div class="line">		ByteArrayOutputStream baos = new ByteArrayOutputStream();	//在内存中创建缓冲区</div><div class="line">		</div><div class="line">		int len;</div><div class="line">		byte[] arr = new byte[8192];</div><div class="line">		while((len = fis.read(arr)) != -1) &#123;</div><div class="line">			baos.write(arr, 0, len);</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">		String str = baos.toString();				//将内存中的内容转换成了字符串</div><div class="line">		viewText.setText(str);</div><div class="line">		</div><div class="line">		fis.close();</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	private void send(byte[] arr, String ip) throws IOException &#123;</div><div class="line">		DatagramPacket packet = </div><div class="line">				new DatagramPacket(arr, arr.length, InetAddress.getByName(ip), 9999);</div><div class="line">		socket.send(packet);						//发送数据</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	private void send() throws IOException &#123;</div><div class="line">		String message = sendText.getText();		//获取发送区域的内容</div><div class="line">		String ip = tf.getText();					//获取ip地址;</div><div class="line">		ip = ip.trim().length() == 0 ? &quot;255.255.255.255&quot; : ip;</div><div class="line">		</div><div class="line">		send(message.getBytes(),ip);</div><div class="line">		</div><div class="line">		String time = getCurrentTime();				//获取当前时间</div><div class="line">		String str = time + &quot; 我对:&quot; + (ip.equals(&quot;255.255.255.255&quot;) ? &quot;所有人&quot; : ip) + &quot;说\r\n&quot; + message + &quot;\r\n\r\n&quot;;	//alt + shift + l 抽取局部变量</div><div class="line">		viewText.append(str);						//将信息添加到显示区域中</div><div class="line">		bw.write(str);								//将信息写到数据库中</div><div class="line">		sendText.setText(&quot;&quot;);</div><div class="line">		</div><div class="line">		</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	private String getCurrentTime() &#123;</div><div class="line">		Date d = new Date();						//创建当前日期对象</div><div class="line">		SimpleDateFormat sdf = new SimpleDateFormat(&quot;yyyy年MM月dd日 HH:mm:ss&quot;);</div><div class="line">		return sdf.format(d);						//将时间格式化</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	public void centerPanel() &#123;</div><div class="line">		Panel center = new Panel();					//创建中间的Panel</div><div class="line">		viewText = new TextArea();</div><div class="line">		sendText = new TextArea(5,1);</div><div class="line">		center.setLayout(new BorderLayout());		//设置为边界布局管理器</div><div class="line">		center.add(sendText,BorderLayout.SOUTH);	//发送的文本区域放在南边</div><div class="line">		center.add(viewText,BorderLayout.CENTER);	//显示区域放在中间</div><div class="line">		viewText.setEditable(false);				//设置不可以编辑</div><div class="line">		viewText.setBackground(Color.WHITE);		//设置背景颜色</div><div class="line">		sendText.setFont(new Font(&quot;xxx&quot;, Font.PLAIN, 15));</div><div class="line">		viewText.setFont(new Font(&quot;xxx&quot;, Font.PLAIN, 15));</div><div class="line">		this.add(center,BorderLayout.CENTER);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	public void southPanel() &#123;</div><div class="line">		Panel south = new Panel();		//创建南边的Panel</div><div class="line">		tf = new TextField(15);</div><div class="line">		tf.setText(&quot;127.0.0.1&quot;);</div><div class="line">		send = new Button(&quot;发 送&quot;);</div><div class="line">		log = new Button(&quot;记 录&quot;);</div><div class="line">		clear = new Button(&quot;清 屏&quot;);</div><div class="line">		shake = new Button(&quot;震 动&quot;);</div><div class="line">		south.add(tf);</div><div class="line">		south.add(send);</div><div class="line">		south.add(log);</div><div class="line">		south.add(clear);</div><div class="line">		south.add(shake);</div><div class="line">		this.add(south,BorderLayout.SOUTH);	//将Panel放在Frame的南边</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	public void init() &#123;</div><div class="line">		this.setLocation(500, 50);</div><div class="line">		this.setSize(400, 600);</div><div class="line">		new Receive().start();</div><div class="line">		try &#123;</div><div class="line">			socket = new DatagramSocket();</div><div class="line">			bw = new BufferedWriter(new FileWriter(&quot;config.txt&quot;,true));	//需要在尾部追加</div><div class="line">		&#125; catch (Exception e) &#123;</div><div class="line">			</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125;</div><div class="line">		this.setVisible(true);</div><div class="line">	&#125;</div><div class="line">	private class Receive extends Thread &#123;			//接收和发送需要同时执行,所以定义成多线程的</div><div class="line">		public void run() &#123;</div><div class="line">			try &#123;</div><div class="line">				DatagramSocket socket = new DatagramSocket(9999);</div><div class="line">				DatagramPacket packet = new DatagramPacket(new byte[8192], 8192);</div><div class="line">				</div><div class="line">				while(true) &#123;</div><div class="line">					socket.receive(packet);				//接收信息</div><div class="line">					byte[] arr = packet.getData();		//获取字节数据</div><div class="line">					int len = packet.getLength();		//获取有效的字节数据</div><div class="line">					if(arr[0] == -1 &amp;&amp; len == 1) &#123;		//如果发过来的数组第一个存储的值是-1,并且数组长度是1</div><div class="line">						shake();						//调用震动方法</div><div class="line">						continue;						//终止本次循环,继续下次循环,因为震动后不需要执行下面的代码</div><div class="line">					&#125;</div><div class="line">					String message = new String(arr,0,len);	//转换成字符串</div><div class="line">					</div><div class="line">					String time = getCurrentTime();		//获取当前时间</div><div class="line">					String ip = packet.getAddress().getHostAddress();	//获取ip地址</div><div class="line">					String str = time + &quot; &quot; + ip + &quot; 对我说:\r\n&quot; + message + &quot;\r\n\r\n&quot;;</div><div class="line">					viewText.append(str);</div><div class="line">					bw.write(str);</div><div class="line">				&#125;</div><div class="line">			&#125; catch (Exception e) &#123;</div><div class="line">				</div><div class="line">				e.printStackTrace();</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	public static void main(String[] args) &#123;</div><div class="line">		new Demo4_GUIChat();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="TCP协议"><a href="#TCP协议" class="headerlink" title="TCP协议"></a>TCP协议</h3><ul>
<li>1.客户端<ul>
<li>创建Socket连接服务端(指定ip地址,端口号)通过ip地址找对应的服务器</li>
<li>调用Socket的getInputStream()和getOutputStream()方法获取和服务端相连的IO流</li>
<li>输入流可以读取服务端输出流写出的数据</li>
<li>输出流可以写出数据到服务端的输入流</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">Socket socket = new Socket(&quot;127.0.0.1&quot;, 12345);</div><div class="line"></div><div class="line">InputStream is = socket.getInputStream();	//获取客户端输入流</div><div class="line">OutputStream os = socket.getOutputStream();	//获取客户端的输出流</div><div class="line"></div><div class="line">byte[] arr = new byte[1024];</div><div class="line">int len = is.read(arr);						//读取服务器发过来的数据</div><div class="line">System.out.println(new String(arr,0,len));  //将数据转换成字符串并打印</div><div class="line"></div><div class="line">os.write(&quot;学习挖掘机哪家强?&quot;.getBytes());			//客户端向服务器写数据</div><div class="line"></div><div class="line">socket.close();</div></pre></td></tr></table></figure>
<ul>
<li>2.服务端<ul>
<li>创建ServerSocket(需要指定端口号)</li>
<li>调用ServerSocket的accept()方法接收一个客户端请求，得到一个Socket</li>
<li>调用Socket的getInputStream()和getOutputStream()方法获取和客户端相连的IO流</li>
<li>输入流可以读取客户端输出流写出的数据</li>
<li>输出流可以写出数据到客户端的输入流</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">ServerSocket server = new ServerSocket(12345);</div><div class="line"></div><div class="line">Socket socket = server.accept();			//接受客户端的请求</div><div class="line">InputStream is = socket.getInputStream();	//获取客户端输入流</div><div class="line">OutputStream os = socket.getOutputStream();	//获取客户端的输出流</div><div class="line"></div><div class="line">os.write(&quot;百度一下你就知道&quot;.getBytes());			//服务器向客户端写出数据</div><div class="line"></div><div class="line">byte[] arr = new byte[1024];</div><div class="line">int len = is.read(arr);						//读取客户端发过来的数据</div><div class="line">System.out.println(new String(arr,0,len));  //将数据转换成字符串并打印</div><div class="line"></div><div class="line">socket.close();</div></pre></td></tr></table></figure>
<h3 id="TCP协议代码优化"><a href="#TCP协议代码优化" class="headerlink" title="TCP协议代码优化"></a>TCP协议代码优化</h3><ul>
<li><p>客户端</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">Socket socket = new Socket(&quot;127.0.0.1&quot;, 9999);		//创建Socket指定ip地址和端口号</div><div class="line">InputStream is = socket.getInputStream();			//获取输入流</div><div class="line">OutputStream os = socket.getOutputStream();			//获取输出流</div><div class="line">BufferedReader br = new BufferedReader(new InputStreamReader(is));</div><div class="line">PrintStream ps = new PrintStream(os);</div><div class="line"></div><div class="line">System.out.println(br.readLine());</div><div class="line">ps.println(&quot;我想吃火锅&quot;);</div><div class="line">System.out.println(br.readLine());</div><div class="line">ps.println(&quot;爷不吃了&quot;);</div><div class="line">socket.close();</div></pre></td></tr></table></figure>
</li>
<li><p>服务端</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">ServerSocket server = new ServerSocket(9999);	//创建服务器</div><div class="line">Socket socket = server.accept();				//接受客户端的请求</div><div class="line">InputStream is = socket.getInputStream();		//获取输入流</div><div class="line">OutputStream os = socket.getOutputStream();		//获取输出流</div><div class="line"></div><div class="line">BufferedReader br = new BufferedReader(new InputStreamReader(is));</div><div class="line">PrintStream ps = new PrintStream(os);</div><div class="line"></div><div class="line">ps.println(&quot;大酬宾&quot;);</div><div class="line">System.out.println(br.readLine());</div><div class="line">ps.println(&quot;卖完了&quot;);</div><div class="line">System.out.println(br.readLine());</div><div class="line">server.close();</div><div class="line">socket.close();</div></pre></td></tr></table></figure>
<h3 id="服务端是多线程的"><a href="#服务端是多线程的" class="headerlink" title="服务端是多线程的"></a>服务端是多线程的</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">ServerSocket server = new ServerSocket(9999);	//创建服务器</div><div class="line">	while(true) &#123;</div><div class="line">		final Socket socket = server.accept();				//接受客户端的请求</div><div class="line">		new Thread() &#123;</div><div class="line">			public void run() &#123;</div><div class="line">				try &#123;</div><div class="line">					BufferedReader br = new BufferedReader(new InputStreamReader(socket.getInputStream()));</div><div class="line">					PrintStream ps = new PrintStream(socket.getOutputStream());</div><div class="line">					ps.println(&quot;大酬宾&quot;);</div><div class="line">					System.out.println(br.readLine());</div><div class="line">					ps.println(&quot;卖完了&quot;);</div><div class="line">					System.out.println(br.readLine());</div><div class="line">					socket.close();</div><div class="line">				&#125; catch (IOException e) &#123;</div><div class="line">					e.printStackTrace();</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;.start();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="网络编程-练习"><a href="#网络编程-练习" class="headerlink" title="网络编程(练习)"></a>网络编程(练习)</h3><ul>
<li><p>客户端向服务器写字符串(键盘录入),服务器(多线程)将字符串反转后写回,客户端再次读取到是反转后的字符串</p>
</li>
<li><p>服务器</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">ServerSocket server = new ServerSocket(54321);</div><div class="line">System.out.println(&quot;服务器启动,绑定54321端口&quot;);</div><div class="line"></div><div class="line">while(true) &#123;</div><div class="line">	final Socket socket = server.accept();	//接受客户端的请求</div><div class="line">	</div><div class="line">	new Thread() &#123;						//开启一条线程</div><div class="line">		public void run() &#123;</div><div class="line">			try &#123;</div><div class="line">				BufferedReader br = new BufferedReader(new InputStreamReader(socket.getInputStream()));	//获取输入流</div><div class="line">				PrintStream ps = new PrintStream(socket.getOutputStream());//获取输出流</div><div class="line">				</div><div class="line">				String line = br.readLine();//将客户端写过来的数据读取出来</div><div class="line">				line = new StringBuilder(line).reverse().toString();	//链式编程</div><div class="line">				ps.println(line);		//反转后写回去</div><div class="line">				socket.close();</div><div class="line">			&#125; catch (IOException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;.start();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">Scanner sc = new Scanner(System.in);				//创建键盘录入对象</div><div class="line">Socket socket = new Socket(&quot;127.0.0.1&quot;, 54321);		//创建客户端,指定ip地址和端口号</div><div class="line"></div><div class="line">BufferedReader br = new BufferedReader(new InputStreamReader(socket.getInputStream()));	//获取输入流</div><div class="line">PrintStream ps = new PrintStream(socket.getOutputStream());//获取输出流</div><div class="line"></div><div class="line">ps.println(sc.nextLine());							//将字符串写到服务器去</div><div class="line">System.out.println(br.readLine()); 					//将反转后的结果读出来</div><div class="line"></div><div class="line">socket.close();</div></pre></td></tr></table></figure>
<h3 id="26-20-网络编程-练习"><a href="#26-20-网络编程-练习" class="headerlink" title="26.20_网络编程(练习)"></a>26.20_网络编程(练习)</h3><ul>
<li><p>客户端向服务器上传文件</p>
</li>
<li><p>客户端</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line">public static void main(String[] args) throws UnknownHostException, IOException &#123;</div><div class="line">	// 1.提示输入要上传的文件路径, 验证路径是否存在以及是否是文件夹</div><div class="line">	File file = getFile();</div><div class="line">	// 2.发送文件名到服务端</div><div class="line">	Socket socket = new Socket(&quot;127.0.0.1&quot;, 12345);</div><div class="line">	BufferedReader br = new BufferedReader(new InputStreamReader(socket.getInputStream()));</div><div class="line">	PrintStream ps = new PrintStream(socket.getOutputStream());</div><div class="line">	ps.println(file.getName());</div><div class="line">	// 6.接收结果, 如果存在给予提示, 程序直接退出</div><div class="line">	String result = br.readLine();						//读取存在后不存在的结果</div><div class="line">	if(&quot;存在&quot;.equals(result)) &#123;</div><div class="line">		System.out.println(&quot;您上传的文件已经存在,请不要重复上传&quot;);</div><div class="line">		socket.close();</div><div class="line">		return;</div><div class="line">	&#125;</div><div class="line">	// 7.如果不存在, 定义FileInputStream读取文件, 写出到网络</div><div class="line">	FileInputStream fis = new FileInputStream(file);</div><div class="line">	byte[] arr = new byte[8192];</div><div class="line">	int len;</div><div class="line">	</div><div class="line">	while((len = fis.read(arr)) != -1) &#123;</div><div class="line">		ps.write(arr, 0, len);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	fis.close();</div><div class="line">	socket.close();</div><div class="line">&#125;</div><div class="line"></div><div class="line">private static File getFile() &#123;</div><div class="line">	Scanner sc = new Scanner(System.in);				//创建键盘录入对象</div><div class="line">	System.out.println(&quot;请输入一个文件路径:&quot;);</div><div class="line">	</div><div class="line">	while(true) &#123;</div><div class="line">		String line = sc.nextLine();</div><div class="line">		File file = new File(line);</div><div class="line">		</div><div class="line">		if(!file.exists()) &#123;</div><div class="line">			System.out.println(&quot;您录入的文件路径不存在,请重新录入:&quot;);</div><div class="line">		&#125;else if(file.isDirectory()) &#123;</div><div class="line">			System.out.println(&quot;您录入的是文件夹路径,请输入一个文件路径:&quot;);</div><div class="line">		&#125;else &#123;</div><div class="line">			return file;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>服务器</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line">//3,建立多线程的服务器</div><div class="line">ServerSocket server = new ServerSocket(12345);</div><div class="line">System.out.println(&quot;服务器启动,绑定12345端口号&quot;);</div><div class="line"></div><div class="line">//4.读取文件名</div><div class="line">while(true) &#123;</div><div class="line">	final Socket socket = server.accept();					//接受请求</div><div class="line">	new Thread() &#123;</div><div class="line">		public void run() &#123;</div><div class="line">			try &#123;</div><div class="line">				InputStream is = socket.getInputStream();</div><div class="line">				BufferedReader br = new BufferedReader(new InputStreamReader(is));</div><div class="line">				PrintStream ps = new PrintStream(socket.getOutputStream());</div><div class="line">				String fileName = br.readLine();</div><div class="line">				</div><div class="line">				//5.判断文件是否存在, 将结果发回客户端</div><div class="line">				File dir = new File(&quot;update&quot;);</div><div class="line">				dir.mkdir();								//创建文件夹</div><div class="line">				File file = new File(dir,fileName);			//封装成File对象</div><div class="line">				</div><div class="line">				if(file.exists()) &#123;							//如果服务器已经存在这个文件</div><div class="line">					ps.println(&quot;存在&quot;);						//将存在写给客户端</div><div class="line">					socket.close();							//关闭socket</div><div class="line">					return;</div><div class="line">				&#125;else &#123;</div><div class="line">					ps.println(&quot;不存在&quot;);</div><div class="line">				&#125;</div><div class="line">				</div><div class="line">				//8.定义FileOutputStream, 从网络读取数据, 存储到本地</div><div class="line">				FileOutputStream fos = new FileOutputStream(file);</div><div class="line">				byte[] arr = new byte[8192];</div><div class="line">				int len;</div><div class="line">				</div><div class="line">				while((len = is.read(arr)) != -1) &#123;</div><div class="line">					fos.write(arr, 0, len);</div><div class="line">				&#125;</div><div class="line">				</div><div class="line">				fos.close();</div><div class="line">				socket.close();</div><div class="line">			&#125; catch (IOException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;.start();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
        </div>
      </div>
    </div>
  </div>
</article>



    <!-- Footer -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <p class="copyright text-muted">
          Theme By <a target="_blank" href="https://github.com/levblanc">Levblanc.</a>
          Inspired By <a target="_blank" href="https://github.com/klugjo/hexo-theme-clean-blog">Clean Blog.</a>
        <p class="copyright text-muted">
          Powered By <a target="_blank" href="https://hexo.io/">Hexo.</a>
        </p>
      </div>
    </div>
  </div>
</footer>


    <!-- After Footer Scripts -->
<script src="/js/highlight.pack.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function(event) {
    var codeBlocks = Array.prototype.slice.call(document.getElementsByTagName('pre'))
    codeBlocks.forEach(function(block, index) {
      hljs.highlightBlock(block);
    });
  });
</script>

  </body>
</html>

